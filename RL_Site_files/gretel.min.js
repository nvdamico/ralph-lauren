"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var r,o,n,i,c,a=gap,u=t[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,c=[],"[object Array]"===Object.prototype.toString.apply(u)){for(i=u.length,r=0;r<i;r+=1)c[r]=str(r,u)||"null";return n=0===c.length?"[]":gap?"[\n"+gap+c.join(",\n"+gap)+"\n"+a+"]":"["+c.join(",")+"]",gap=a,n}if(rep&&"object"==typeof rep)for(i=rep.length,r=0;r<i;r+=1)"string"==typeof rep[r]&&(o=rep[r],(n=str(o,u))&&c.push(quote(o)+(gap?": ":":")+n));else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(n=str(o,u))&&c.push(quote(o)+(gap?": ":":")+n);return n=0===c.length?"{}":gap?"{\n"+gap+c.join(",\n"+gap)+"\n"+a+"}":"{"+c.join(",")+"}",gap=a,n}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,r){var o;if(gap="",indent="","number"==typeof r)for(o=0;o<r;o+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var r,o,n=e[t];if(n&&"object"==typeof n)for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o=walk(n,r),void 0!==o?n[r]=o:delete n[r]);return reviver.call(e,t,n)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){"use strict";function t(){return P.useTest?"staging.cquotient.com":"cquotient.com"}function r(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){if("sortDetails"===r){t.push(r+"::OMITTED_BY_GRETEL");continue}t.push(r+"::"+e[r])}return t.join("||")}function o(e){for(var t=[],o=0;o<e.length;o++){var n=e[o];"[object Object]"===Object.prototype.toString.call(n)?t.push(r(n)):t.push(n)}return t.join(";;")}function n(e){var t=["%23","%24","%26","%2B","%5E","%60","%7C","%2F","%3A","%3C","%3D","%3E","%3F","%40","%5B","%5D","%7B","%7D"],r=new RegExp(t.join("|"),"g"),o=encodeURIComponent(e);return o=o.replace(r,decodeURIComponent)}function i(e,t){var r=n(t.value)||"",o=n(e)+"="+r+";";t.domain&&(o+=" domain="+t.domain+";"),t.path&&(o+=" path="+t.path+";"),t.expires&&(o+=" expires="+t.expires+";"),document.cookie=o}function c(e){var t=JSON.stringify(e);for(var r in V)if(V.hasOwnProperty(r)){var o=new RegExp(r,"g");t=t.replace(o,V[r])}return n(t)}function a(e){try{for(var t in V)if(V.hasOwnProperty(t)){var r=new RegExp(V[t],"g");e=e.replace(r,t)}return JSON.parse(e)}catch(t){return P.sendActivity("cq","error",{time:(new Date).getTime(),error:"Decoding failed on: "+e}),[]}}function u(e,t,r,o){try{window.sessionStorage.setItem("cq."+t,JSON.stringify(e))}catch(t){var n=P.byteLength(c(e));n+document.cookie.length>4e3?P.sendActivity(o,"error",{time:(new Date).getTime(),error:r+"  too large"}):i(r,{value:c(e),path:"/"})}}function s(){return-1!==document.cookie.indexOf("__cq_dnt=1")}function d(){try{for(var e=["cqcid","cquid","__cq_uuid","__cqact","__cqviews","__cq_bc","__cq_seg","__cq_anchor"],t=(e.length,document.cookie.split(";")),r=0,o=t.length;r<o;r++){var n=t[r],i=n.indexOf("="),c=(i>-1?n.substr(0,i):n).trim();-1!==e.indexOf(c)&&(document.cookie=c+"=; path=/; domain="+Q+"; expires=Thu, 01 Jan 1970 00:00:00 GMT")}}catch(e){}}function p(e){for(var t,r=window.location.search.substring(1),o=r.split("&"),n=0,i=o.length;n<i;n++){var c=o[n].split("=");if(decodeURIComponent(c[0])===e){t=decodeURIComponent(c[1]);break}}return t}function f(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],c=encodeURIComponent(n)+"=";"[object Object]"===Object.prototype.toString.call(i)?c+=encodeURIComponent(r(i)):"[object Array]"===Object.prototype.toString.call(i)?c+=encodeURIComponent(o(i)):c+=encodeURIComponent(i),t.push(c)}return t.join("&").length<1e3&&t.push("json="+encodeURIComponent(JSON.stringify(e))),t.join("&")}function l(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1").replace(/\+/g,"%20"))||null}function v(){for(var e=document.cookie.split(";"),t=0,r=e.length;t<r;t++){var o=e[t].trim().split("=");if(0===o[0].indexOf("dwpersonalization_"))return o[1]}}function m(e){for(var t,r,o=[void 0],n="",c=document.location.hostname.split(".").reverse(),a=0,u=c.length;a<u;a++)n="."+c[a]+n,o.push(n);try{t=l(e)}catch(e){t=void 0}for(var s=0,d=o.length;s<d;s++){var p=o[s];i(e,{domain:p,path:"/",expires:"Thu, 01 Jan 1970 00:00:00 UTC"});try{r=l(e)}catch(e){r=void 0}if(t!==r)return i(e,{value:t,domain:p,path:"/"}),p}}function h(e){i(e,{path:"/",expires:"Thu, 01 Jan 1970 00:00:00 UTC",domain:m(e)})}function g(){var e,t;try{e=window.sessionStorage.getItem("cq.anchor")}catch(t){e=l("__cq_anchor")}try{t=JSON.parse(e)||{}}catch(e){t={}}return t}function y(e){var t,r;try{t=l("__cq_bc"),t||(t=l("bc")),t&&(t=t.replace(/^j:/,""),t=JSON.parse(t),r={},r[e]=t[e],r=JSON.stringify(r))}catch(e){}return r}function _(e,t){try{var r=window.sessionStorage.getItem("cq."+e);if(!r)return[];try{return JSON.parse(r)}catch(e){return[]}}catch(e){var o=l(t);return o?a(o):[]}}function w(){return _("viewReco","__cqviews")}function I(){return _("viewSearch","__cqsviews")}function k(){return _("viewCategory","__cqcviews")}function T(e,t){var r=G[t.recommenderName]=G[t.recommenderName]||[];r.push(t.products),clearTimeout(W[t.recommenderName]),W[t.recommenderName]=window.setTimeout(function(){for(var o=[],n=0;n<r.length;n++)o=o.concat(r[n]);t.products=o,P.sendActivity(e,"viewReco",t);var i=w();i.push({recommenderName:t.recommenderName,cookieId:t.cookieId,userId:t.userId,products:t.products}),u(i,"viewReco","__cqviews",e)},0)}function b(e,t){var r=Y[t.searchText]=Y[t.searchText]||[];r.push(t.products),clearTimeout(z[t.searchText]),z[t.searchText]=window.setTimeout(function(){for(var o=[],n=0;n<r.length;n++)o=o.concat(r[n]);t.products=o,P.sendActivity(e,"viewSearch",t),Y[t.searchText]=[];var i=I();i.push({searchText:t.searchText,refinements:t.refinements,cookieId:t.cookieId,userId:t.userId,products:t.products}),u(i,"viewSearch","__cqsviews",e)},0)}function S(e,t){var r=t.categoryId,o=H[r]=H[r]||[];o.push(t.products),clearTimeout(Z[r]),Z[r]=window.setTimeout(function(){for(var n=[],i=0;i<o.length;i++)n=n.concat(o[i]);t.products=n,P.sendActivity(e,"viewCategory",t),H[r]=[];var c=k();c.push({refinements:t.refinements,categoryId:t.categoryId,cookieId:t.cookieId,userId:t.userId,products:t.products}),u(c,"viewCategory","__cqcviews",e)},0)}function q(e,t){for(var r=0;r<K.length;r++)for(var o=K[r].products,n=0;n<o.length;n++)if(o[n].id===t.id){var i={recommenderName:K[r].recommenderName,product:t,cookieId:K[r].cookieId,userId:K[r].userId,anchors:te[K[r].recommenderName]};return void P.sendActivity(e,"_clickReco",i)}}function O(e,t){for(var r=0;r<X.length;r++)for(var o=X[r].products,n=0;n<o.length;n++)if(o[n].id===t.id){var i={searchText:X[r].searchText,refinements:X[r].refinements,product:t,cookieId:X[r].cookieId,userId:X[r].userId};return void P.sendActivity(e,"clickSearch",i)}}function x(){try{return window.localStorage.setItem("cq","cq"),window.localStorage.removeItem("cq"),!0}catch(e){return!1}}function N(e,t){for(var r=0;r<ee.length;r++)for(var o=ee[r].products,n=0;n<o.length;n++)if(o[n].id===t.id){var i={refinements:ee[r].refinements,product:t,categoryId:ee[r].categoryId,cookieId:ee[r].cookieId,userId:ee[r].userId};return void P.sendActivity(e,"clickCategory",i)}}function C(){return!!(P.activities&&P.activities.length>0)||!!l("__cqact")}function j(e,t){if(e){var r=g(),o=t.map(function(e){return e.type&&"vgroup"===e.type&&e.alt_id?e.alt_id:e.id});r[e]=o;var n=JSON.stringify(r);try{window.sessionStorage.setItem("cq.anchor",n)}catch(e){i("__cq_anchor",{value:n,domain:m("__cq_anchor"),path:"/"})}}}function R(e,t,r,o){var n={clientId:e,activityType:t,params:r,callback:o};F.push(n)}function J(){for(var e=0,t=F.length;e<t;e++){var r=F[e];P.sendActivity(r.clientId,r.activityType,r.params,r.callback)}F=[]}function A(){return!!l("__cq_uuid")}function D(){if(P.clientId)try{var e=l("__cqact");if(!e)return void window.setTimeout(D,100);var t=JSON.parse(e);if(!t[0])return h("__cqact"),void window.setTimeout(D,100);P.sendActivity(P.clientId,t[0].activityType,t[0].parameters,function(){E(t[0])})}catch(e){P.sendActivity(P.clientId,"error",{time:(new Date).getTime(),caughtError:e}),h("__cqact")}}function E(e){try{var t=l("__cqact");if(!t)return void D();for(var r=JSON.stringify(e.parameters.product||e.parameters.products),o=JSON.parse(t),n=m("__cqact"),c=0,a=o.length;c<a;c++)if(o[c].activityType===e.activityType&&JSON.stringify(o[c].parameters.product||o[c].parameters.products)===r){if(o.splice(c,1),i("__cqact",{value:JSON.stringify(o),domain:n,path:"/"}),JSON.parse(l("__cqact")).length===a)throw new Error("error deleting activity cookie");break}D()}catch(e){P.sendActivity(P.clientId,"error",{time:(new Date).getTime(),caughtError:e}),h("__cqact")}}function U(e){e=e.toLowerCase();for(var t=0;t<ie.length;t++){var r=ie[t];if(e.indexOf(r)>=0)return r}return"other"}var P=e.CQuotient=window.CQuotient||(e.CQuotient={});P.VERSION="v2.13.0";var M=0,F=[],B=!0,L=!1;P.byteLength=function(e){for(var t=e.length,r=0,o=e.length;r<o;r++){var n=e.charCodeAt(r);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=55296&&n<=56319&&r++}return t};var V={"},{":"-~-",'"id":':"i~%",',"sku":""':"s~!",',"sku":':"s~%"};P._getTopDomain=function(e){var t,r,o="weird_get_top_level_domain=cookie",n=e.split(".");for(t=n.length-1;t>=0;t--)if(r=n.slice(t).join("."),document.cookie=o+";domain=."+r+";",document.cookie.indexOf(o)>-1)return document.cookie=o.split("=")[0]+"=;domain=."+r+";expires=Thu, 01 Jan 1970 00:00:01 GMT;","."+r;return!1};var Q=P._getTopDomain(document.location.hostname),$={customerSignup:["cookieId","userId","emailId"],viewPage:["cookieId","pageId"],viewProduct:["cookieId","product"],search:["cookieId","searchText"],viewSearch:["cookieId","searchText","products"],clickSearch:["cookieId","searchText","product"],viewCategory:["cookieId","categoryId"],clickCategory:["cookieId","categoryId"],viewCart:["cookieId","products"],addToCart:["cookieId","product"],removeFromCart:["cookieId","product"],beginCheckout:["cookieId","products","amount"],finishCheckout:["cookieId","products","amount"],reviewProduct:["cookieId","product","rating"],clickReco:["cookieId","product"],_clickReco:["cookieId","product"],viewWishList:["cookieId"],addToWishList:["cookieId"],removeFromWishList:["cookieId"],viewReco:["cookieId"],servedReco:[],error:[]},G={},W={},Y={},z={},H={},Z={},K=w();try{window.sessionStorage.removeItem("cq.viewReco")}catch(e){document.cookie="__cqviews=;path=/;"}var X=I();try{window.sessionStorage.removeItem("cq.viewSearch")}catch(e){document.cookie="__cqsviews=;path=/;"}var ee=k();try{window.sessionStorage.removeItem("cq.viewCategory")}catch(e){document.cookie="__cqcviews=;path=/;"}var te=g();try{window.sessionStorage.removeItem("cq.anchor")}catch(e){h("__cq_anchor")}var re=!1;if(window.setTimeout(function(){re||!P.clientId||C()||P.sendActivity(P.clientId,"viewPage",{cookieId:l("cqcid")})},1e3),P.sendActivity=function(e,r,o,n){function i(){delete P[k],j.parentNode.removeChild(j)}if(s())return d(),new Image;if(!e)throw new Error("Must provide a clientId");if(!$.hasOwnProperty(r))throw new Error("Unsupported activity type!");if(re=!0,o=o||{},"viewReco"===r){if(o.accumulate)return delete o.accumulate,void T(e,o);var c=g(),a=o.recommenderName;c.hasOwnProperty(a)&&(o.anchors=c[a])}if("viewSearch"===r&&o.accumulate)return delete o.accumulate,void b(e,o);if("viewCategory"===r&&o.accumulate)return delete o.accumulate,void S(e,o);if("viewProduct"===r&&(q(e,o.product),O(e,o.product),N(e,o.product)),!("clickReco"===r&&K.length>0)){var u=p("__cq_eid");u&&(o.emailId=u),"_clickReco"===r&&(r="clickReco"),o.referrer=window.document.referrer;var m=l("__cq_uuid");m&&(o.__cq_uuid=m);var h=l("__cq_seg");h&&(o.__cq_seg=h);var _=v();_&&(o.__dw_p=_);var w="https://p."+t()+"/pebble?tla="+e+"&activityType="+r,I=y(e);I&&(o.bc=I),o.ls=x(),w+="&_="+(new Date).getTime();var k="_act_callback"+M++;w+="&callback=CQuotient."+k,o.v=P.VERSION;var C=f(o);if(C.length>0&&(w+="&"+C),!A()&&!L){if(!B)return void R(e,r,o,n);B=!1}var j=document.createElement("script");return j.src=w,j.type="text/javascript",P[k]=function(e){if("[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),"[object Array]"===Object.prototype.toString.call(e))for(var t=0,r=e.length;t<r;t++)document.cookie=e[t].k+"="+e[t].v+";path=/;domain="+(Q||e[t].d)+";max-age="+e[t].m;A()||(L=!0),J(),i(),n&&n()},document.getElementsByTagName("body")[0].appendChild(j),new Image}},P.clientId&&P.activities&&P.activities.length>0){for(var oe=0;oe<P.activities.length;oe++){var ne=P.activities[oe];P.sendActivity(P.clientId,ne.activityType,ne.parameters)}P.activities=[]}D();var ie=["ipad","iphone","android","windows","mac"],ce={pdp:!0,topsellers:!0,v2v:!0};if(P.getRecs=function(e,r,o,n,i){function c(){delete P[m],I.parentNode.removeChild(I),window.clearTimeout(k)}var a=new Date;if(!e)return void(i&&i({errorMessage:'Invalid value for "clientId":'+e}));if(!r)return void(i&&i({errorMessage:'Invalid value for "recommenderName":'+r}));o=o||{};var u=l("__cq_uuid");u&&(o.__cq_uuid=u);var s=!1;for(var d in ce)ce.hasOwnProperty(d)&&r.indexOf(d)>=0&&(s=ce[d]);var p,v=o.timeoutMs||5e3,m="_callback"+M++,h="recs/"+e+"/"+r+"?callback=CQuotient."+m;if(s?p="r":(h+="&_="+(new Date).getTime(),p="e"),o.filters){var g=o.filters;delete o.filters,g.fieldsToMatchToValue&&(o.filter_fieldsToMatchToValue=g.fieldsToMatchToValue)}r&&o.hasOwnProperty("anchors")&&j(r,o.anchors),o.v=P.VERSION,h+="&_device="+U(navigator.userAgent);var _=y(e);_&&(o.bc=_);var w=f(o);w.length>0&&(h+="&"+w);var I=document.createElement("script");I.src="https://"+p+"."+t()+"/"+h,I.type="text/javascript";var k=window.setTimeout(function(){try{i&&i({errorMessage:"Reco request timed out for recommender: "+r})}finally{c()}},v);P[m]=function(t){try{if("[object Object]"===Object.prototype.toString.call(t))try{n(t)}catch(r){P.sendActivity(e,"error",{time:new Date-a,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{P.sendActivity(e,"servedReco",{time:new Date-a,recommenderName:r,recoRequestParams:o,recoResponse:t})}else if(i)try{i(t)}finally{P.sendActivity(e,"error",{time:new Date-a,recoRequestParams:o,recoResponse:t})}}catch(r){P.sendActivity(e,"error",{time:new Date-a,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{c()}},document.getElementsByTagName("body")[0].appendChild(I)},P.enableDNT=function(){i("__cq_dnt",{domain:Q,value:1,expires:new Date(Date.now()+189216e5)}),d()},P.disableDNT=function(){i("__cq_dnt",{domain:Q,value:0,expires:new Date(Date.now()+189216e5)})},P.clientId&&P.widgets&&P.widgets.length>0){for(var ae=0;ae<P.widgets.length;ae++){var ue=P.widgets[ae];P.getRecs(P.clientId,ue.recommenderName,ue.parameters,ue.callback,ue.errorCallback)}P.widgets=[]}}("undefined"!=typeof module&&module.exports?exports:window);
